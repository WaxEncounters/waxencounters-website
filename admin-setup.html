<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Setup - Wax Encounters</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        .glass-card { background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(25px); border: 1px solid rgba(255, 255, 255, 0.15); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4); }
        .main-background { position: fixed; top: 0; left: 0; right: 0; height: 200vh; background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('images/background image.jpeg'); background-size: cover; background-position: center top; background-repeat: no-repeat; z-index: -1; }
        .premium-button { background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%); box-shadow: 0 4px 20px rgba(255, 255, 255, 0.3), 0 0 40px rgba(255, 255, 255, 0.1); transition: all 0.3s ease; }
        .premium-button:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(255, 255, 255, 0.4), 0 0 60px rgba(255, 255, 255, 0.2); }
    </style>
    <link rel="icon" href="data:,">
</head>
<body class="text-white overflow-x-hidden">
    <div class="main-background"></div>
    
    <main class="min-h-screen flex items-center justify-center">
        <section class="relative">
            <div class="max-w-md mx-auto px-4 sm:px-6 lg:px-8">
                <div class="glass-card rounded-2xl p-8">
                    <h1 class="text-3xl font-extrabold mb-2 tracking-tight text-center">Admin Setup</h1>
                    <p class="text-lg text-gray-300 text-center mb-8">Create your admin account</p>
                    
                    <form id="adminSetupForm" class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Admin Username</label>
                            <input id="adminUsername" type="text" required placeholder="Enter admin username" class="w-full px-4 py-3 bg-white bg-opacity-10 rounded-xl border border-white border-opacity-20 focus:outline-none focus:border-pink-400 focus:bg-opacity-15 transition-all duration-200 text-base">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Admin Password</label>
                            <input id="adminPassword" type="password" required placeholder="Enter admin password (min 8 characters)" class="w-full px-4 py-3 bg-white bg-opacity-10 rounded-xl border border-white border-opacity-20 focus:outline-none focus:border-pink-400 focus:bg-opacity-15 transition-all duration-200 text-base">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Confirm Password</label>
                            <input id="confirmPassword" type="password" required placeholder="Confirm admin password" class="w-full px-4 py-3 bg-white bg-opacity-10 rounded-xl border border-white border-opacity-20 focus:outline-none focus:border-pink-400 focus:bg-opacity-15 transition-all duration-200 text-base">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Master Key</label>
                            <input id="masterKey" type="password" required placeholder="Enter master setup key" class="w-full px-4 py-3 bg-white bg-opacity-10 rounded-xl border border-white border-opacity-20 focus:outline-none focus:border-pink-400 focus:bg-opacity-15 transition-all duration-200 text-base">
                        </div>
                        
                        <button type="submit" class="premium-button w-full px-8 py-4 text-black font-semibold rounded-xl text-lg hover:scale-105 transition-transform duration-200">
                            Create Admin Account
                        </button>
                    </form>
                    
                    <div class="mt-6 text-center">
                        <a href="login.html" class="text-pink-400 hover:text-pink-300 transition-colors duration-200 text-sm">
                            Back to Login
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Check URL parameters for setup key
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const setupKey = urlParams.get('key');
            
            // Master setup key (secure)
            const validSetupKey = 'Zx3$mK9#pL2@vR8nQ';
            
            if (setupKey !== validSetupKey) {
                alert('Access denied. Invalid setup key.');
                window.location.href = 'login.html';
                return;
            }
            
            // Check if admin already exists
            const existingAdmin = localStorage.getItem('adminAccount');
            if (existingAdmin) {
                const proceed = confirm('Admin account already exists. Do you want to create a new one?');
                if (!proceed) {
                    window.location.href = 'login.html';
                    return;
                }
            }
        });

        // Handle form submission
        document.getElementById('adminSetupForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const masterKey = document.getElementById('masterKey').value;
            
            // Validate inputs
            if (!username || !password || !confirmPassword || !masterKey) {
                alert('Please fill in all fields.');
                return;
            }
            
            if (password.length < 8) {
                alert('Password must be at least 8 characters long.');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('Passwords do not match.');
                return;
            }
            
            // Verify master key
            if (masterKey !== 'P5@vR8#mK9$nQ2xL7') { // Secure master key
                alert('Invalid master key.');
                return;
            }
            
            // Create admin account
            const adminAccount = {
                username: username,
                password: password,
                role: 'admin',
                createdAt: new Date().toISOString(),
                permissions: ['view_users', 'manage_campaigns', 'process_refunds', 'view_analytics'],
                createdBy: 'setup_page'
            };
            
            // Store admin account
            localStorage.setItem('adminAccount', JSON.stringify(adminAccount));
            localStorage.setItem('adminSession', 'true');
            
            alert('Admin account created successfully! You are now logged in as admin.');
            window.location.href = 'admin-dashboard.html';
        });
    </script>
</body>
</html>
